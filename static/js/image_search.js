// Copied from app/static/js/image_search.js
"use strict";


// (A) Improved mapping: curated SerpApi URLs, then keyword lists (most specific to general)
const serpImageMap = {
    // --- Full coverage for new templates ---
    'Arrive at the airport.': { keywords: ['airport', 'child at airport', 'family airport'] },
    'Go through security.': { keywords: ['airport security', 'child airport security'] },
    'Wait at the gate.': { keywords: ['airport gate', 'child waiting airport'] },
    'Board the airplane.': { keywords: ['boarding airplane', 'child boarding plane'] },
    'Look out the window and fly!': { keywords: ['child airplane window', 'airplane flying child'] },
    'Pack your suitcase.': { keywords: ['child packing suitcase', 'child suitcase', 'family travel'] },
    'Visit the animal shelter.': { keywords: ['animal shelter', 'child animal shelter'] },
    'Pick out a pet.': { keywords: ['child picking pet', 'adopt pet child'] },
    'Bring your pet home.': { keywords: ['child with new pet', 'child pet home'] },
    'Feed your pet.': { keywords: ['child feeding pet', 'pet food child'] },
    'Play with your pet.': { keywords: ['child playing with pet', 'child pet play'] },
    'Give your pet a name.': { keywords: ['child naming pet', 'child pet name'] },
    'Look out the window at the rain.': { keywords: ['child looking at rain', 'rainy day child'] },
    'Put on your raincoat.': { keywords: ['child raincoat', 'child putting on raincoat'] },
    'Jump in puddles.': { keywords: ['child jumping puddles', 'child puddle rain'] },
    'Come inside and dry off.': { keywords: ['child drying off', 'child after rain'] },
    'Drink hot chocolate.': { keywords: ['child drinking hot chocolate', 'hot chocolate child'] },
    'Pack your backpack.': { keywords: ['child packing backpack', 'child backpack camping'] },
    'Set up the tent.': { keywords: ['child setting up tent', 'camping tent child'] },
    'Go for a hike.': { keywords: ['child hiking', 'child hike camping'] },
    'Roast marshmallows.': { keywords: ['child roasting marshmallows', 'campfire marshmallows child'] },
    'Tell stories by the campfire.': { keywords: ['child campfire stories', 'campfire child'] },
    'Sleep under the stars.': { keywords: ['child sleeping under stars', 'camping stars child'] },
    'Pack your toys.': { keywords: ['child packing toys', 'moving house child'] },
    'Say goodbye to your old house.': { keywords: ['child goodbye house', 'moving house child'] },
    'Drive to your new house.': { keywords: ['child in car moving', 'moving house child'] },
    'Unpack your things.': { keywords: ['child unpacking', 'moving in child'] },
    'Meet your new neighbors.': { keywords: ['child meeting neighbors', 'new neighbors child'] },
    'Wake up early.': { keywords: ['child waking up early', 'child morning school'] },
    'Put on your new backpack.': { keywords: ['child new backpack', 'child backpack school'] },
    'Meet your teacher.': { keywords: ['child meeting teacher', 'school teacher child'] },
    'Make new friends.': { keywords: ['child making friends', 'school friends child'] },
    'Tell your family about your day.': { keywords: ['child telling family', 'child after school'] },
    'Wash your hands.': { keywords: ['child washing hands', 'child hygiene'] },
    'Mix the ingredients.': { keywords: ['child mixing ingredients', 'child baking'] },
    'Shape the cookies.': { keywords: ['child shaping cookies', 'child baking cookies'] },
    'Bake in the oven.': { keywords: ['child baking oven', 'child oven cookies'] },
    'Eat the cookies with family.': { keywords: ['child eating cookies', 'family cookies child'] },
    'Arrive at the salon.': { keywords: ['child at salon', 'child hair salon'] },
    'Sit in the big chair.': { keywords: ['child salon chair', 'child haircut chair'] },
    'Get your hair washed.': { keywords: ['child hair washed', 'child salon wash'] },
    'Get your hair cut.': { keywords: ['child haircut', 'child getting haircut'] },
    'See your new haircut in the mirror.': { keywords: ['child new haircut', 'child mirror haircut'] },
    'Wait at the bus stop.': { keywords: ['child bus stop', 'child waiting bus'] },
    'Get on the bus.': { keywords: ['child getting on bus', 'child bus ride'] },
    'Find a seat.': { keywords: ['child bus seat', 'child sitting bus'] },
    'Look out the window.': { keywords: ['child looking out window', 'child bus window'] },
    'Get off at your stop.': { keywords: ['child getting off bus', 'child bus stop'] },
    'Put on your winter clothes.': { keywords: ['child winter clothes', 'child dressing winter'] },
    'Build a snowman.': { keywords: ['child building snowman', 'child snowman'] },
    'Have a snowball fight.': { keywords: ['child snowball fight', 'child playing snow'] },
    'Drink hot soup.': { keywords: ['child drinking soup', 'child hot soup'] },
    'Warm up by the fire.': { keywords: ['child by fire', 'child warming up fire'] },
    'Arrive at the museum.': { keywords: ['child at museum', 'museum entrance child'] },
    'See the dinosaur skeleton.': { keywords: ['child dinosaur skeleton', 'museum dinosaur child'] },
    'Look at paintings.': { keywords: ['child looking at paintings', 'museum paintings child'] },
    'Try the science exhibit.': { keywords: ['child science exhibit', 'museum science child'] },
    'Eat lunch in the museum cafe.': { keywords: ['child eating lunch museum', 'museum cafe child'] },
    'See the cows.': { keywords: ['child seeing cows', 'farm cows child'] },
    'Feed the chickens.': { keywords: ['child feeding chickens', 'farm chickens child'] },
    'Ride on a tractor.': { keywords: ['child riding tractor', 'farm tractor child'] },
    'Pick vegetables.': { keywords: ['child picking vegetables', 'farm vegetables child'] },
    'Say goodbye to the animals.': { keywords: ['child saying goodbye animals', 'farm animals child'] },
    'Arrive at the train station.': { keywords: ['child train station', 'train station child'] },
    'Get on the train.': { keywords: ['child getting on train', 'child train ride'] },
    'Find your seat.': { keywords: ['child train seat', 'child sitting train'] },
    'Look out the window.': { keywords: ['child looking out train window', 'train window child'] },
    'Arrive at your destination.': { keywords: ['child arriving destination', 'child travel destination'] },
    'Pack a picnic basket.': { keywords: ['child picnic basket', 'child packing picnic'] },
    'Find a spot in the park.': { keywords: ['child park picnic', 'child finding spot park'] },
    'Eat sandwiches and fruit.': { keywords: ['child eating sandwiches', 'child eating fruit picnic'] },
    'Play frisbee.': { keywords: ['child playing frisbee', 'child frisbee park'] },
    'Lie on the grass and watch the clouds.': { keywords: ['child lying on grass', 'child watching clouds'] },
    'Put on your sports uniform.': { keywords: ['child sports uniform', 'child putting on uniform'] },
    'Warm up with your team.': { keywords: ['child warming up team', 'child sports warmup'] },
    'Play the game.': { keywords: ['child playing game', 'child sports game'] },
    'Shake hands with the other team.': { keywords: ['child shaking hands', 'child sports handshake'] },
    'Celebrate with your friends.': { keywords: ['child celebrating friends', 'child sports celebration'] },
    'Pick a movie to watch.': { keywords: ['child picking movie', 'child movie night'] },
    'Make popcorn.': { keywords: ['child making popcorn', 'child popcorn movie'] },
    'Turn off the lights.': { keywords: ['child turning off lights', 'movie night lights off'] },
    'Watch the movie.': { keywords: ['child watching movie', 'movie night child'] },
    'Talk about your favorite part.': { keywords: ['child talking about movie', 'child favorite movie part'] },
    'Dig in the dirt.': { keywords: ['child digging dirt', 'child gardening'] },
    'Plant seeds.': { keywords: ['child planting seeds', 'child garden seeds'] },
    'Water the plants.': { keywords: ['child watering plants', 'child garden water'] },
    'Watch the plants grow.': { keywords: ['child watching plants grow', 'child garden grow'] },
    'Pick flowers or vegetables.': { keywords: ['child picking flowers', 'child picking vegetables'] },
    'Drive to grandparents\' house.': { keywords: ['child driving to grandparents', 'child visiting grandparents'] },
    'Give a big hug.': { keywords: ['child giving hug', 'child hug grandparents'] },
    'Bake cookies together.': { keywords: ['child baking cookies', 'child baking with family'] },
    'Play board games.': { keywords: ['child playing board games', 'child board games family'] },
    'Say goodbye and promise to visit again.': { keywords: ['child saying goodbye', 'child promise visit'] },
    'Put on your space suit.': { keywords: ['child space suit', 'child astronaut suit'] },
    'Blast off in a rocket.': { keywords: ['child rocket launch', 'child blasting off'] },
    'Float in zero gravity.': { keywords: ['child zero gravity', 'child floating space'] },
    'See the stars and planets.': { keywords: ['child stars planets', 'child space stars'] },
    'Return safely to Earth.': { keywords: ['child returning to earth', 'child space return'] },
    'Put on your superhero cape.': { keywords: ['child superhero cape', 'child superhero costume'] },
    'Help someone in need.': { keywords: ['child helping others', 'child superhero help'] },
    'Save the day.': { keywords: ['child saving day', 'child superhero save'] },
    'Take a superhero nap.': { keywords: ['child superhero nap', 'child nap superhero'] },
    'Dream of new adventures.': { keywords: ['child dreaming adventure', 'child superhero dream'] },
    'Pick an instrument.': { keywords: ['child picking instrument', 'child music instrument'] },
    'Learn a new song.': { keywords: ['child learning song', 'child music lesson'] },
    'Play with your friends.': { keywords: ['child playing with friends', 'child music friends'] },
    'Perform for your family.': { keywords: ['child performing family', 'child music performance'] },
    'Take a bow.': { keywords: ['child taking a bow', 'child music bow'] },
    'Realize you are lost.': { keywords: ['child lost', 'child realizing lost'] },
    'Look for a safe adult.': { keywords: ['child looking for adult', 'child safe adult'] },
    'Ask for help.': { keywords: ['child asking for help', 'child help lost'] },
    'Wait in a safe place.': { keywords: ['child waiting safe place', 'child safe place lost'] },
    'Be reunited with your family.': { keywords: ['child reunited family', 'child found family'] },
    'Hear the fire alarm.': { keywords: ['child fire alarm', 'child hearing fire alarm'] },
    'Line up with your class.': { keywords: ['child lining up class', 'child fire drill line'] },
    'Walk outside safely.': { keywords: ['child walking outside', 'child fire drill outside'] },
    'Wait for the all clear.': { keywords: ['child waiting all clear', 'child fire drill wait'] },
    'Return to class.': { keywords: ['child returning to class', 'child fire drill return'] },
    'Plan a surprise.': { keywords: ['child planning surprise', 'child surprise party'] },
    'Hide and wait.': { keywords: ['child hiding', 'child waiting surprise'] },
    'Shout "Surprise!"': { keywords: ['child shouting surprise', 'child surprise party'] },
    'Eat cake.': { keywords: ['child eating cake', 'child birthday cake'] },
    'Open presents.': { keywords: ['child opening presents', 'child birthday presents'] },
    'Put on your soccer uniform.': { keywords: ['child soccer uniform', 'child putting on uniform'] },
    'Warm up with your team.': { keywords: ['child warming up soccer', 'child soccer warmup'] },
    'Play the game.': { keywords: ['child playing soccer', 'child soccer game'] },
    'Score a goal.': { keywords: ['child scoring goal', 'child soccer goal'] },
    'Celebrate with your team.': { keywords: ['child celebrating soccer', 'child soccer celebration'] },
    'Put on your helmet.': { keywords: ['child putting on helmet', 'child bike helmet'] },
    'Get on your bike.': { keywords: ['child getting on bike', 'child bike ride'] },
    'Practice pedaling.': { keywords: ['child practicing pedaling', 'child bike pedaling'] },
    'Try without training wheels.': { keywords: ['child without training wheels', 'child bike no training wheels'] },
    'Ride all by yourself!': { keywords: ['child riding bike', 'child bike alone'] },
    'Feed your pet.': { keywords: ['child feeding pet', 'pet food child'] },
    'Give your pet water.': { keywords: ['child giving pet water', 'pet water child'] },
    'Brush your pet.': { keywords: ['child brushing pet', 'pet brush child'] },
    'Play with your pet.': { keywords: ['child playing with pet', 'child pet play'] },
    'Take your pet to the vet.': { keywords: ['child pet vet', 'child taking pet to vet'] },
    'Play with your sibling.': { keywords: ['child playing with sibling', 'child sibling play'] },
    'Share your toys.': { keywords: ['children sharing toys', 'kids sharing', 'child playing toys', 'child friends'] },
    'Help your sibling.': { keywords: ['child helping sibling', 'child sibling help'] },
    'Say sorry if you argue.': { keywords: ['child saying sorry', 'child sibling argue'] },
    'Give your sibling a hug.': { keywords: ['child hugging sibling', 'child sibling hug'] },
    'Decorate the house.': { keywords: ['child decorating house', 'birthday decorations', 'kids party decor'] },
    'Make a holiday card.': { keywords: ['child making holiday card', 'holiday card child'] },
    'Eat a special meal.': { keywords: ['child eating special meal', 'holiday meal child'] },
    'Give a gift.': { keywords: ['child giving gift', 'holiday gift child'] },
    'Say thank you.': { keywords: ['child saying thank you', 'kids gratitude', 'birthday thank you'] },
    'Wash your hands.': { keywords: ['child washing hands', 'child hygiene'] },
    'Bring a card or gift.': { keywords: ['child bringing card', 'child bringing gift'] },
    'Say hello.': { keywords: ['child saying hello', 'child greeting'] },
    'Talk quietly.': { keywords: ['child talking quietly', 'child quiet talk'] },
    'Say goodbye and wish them well.': { keywords: ['child saying goodbye', 'child wishing well'] },
    'Put on your safety goggles.': { keywords: ['child safety goggles', 'child science goggles'] },
    'Mix the ingredients.': { keywords: ['child mixing ingredients', 'child science experiment'] },
    'Watch what happens.': { keywords: ['child watching experiment', 'child science result'] },
    'Write down your results.': { keywords: ['child writing results', 'child science notes'] },
    'Clean up your workspace.': { keywords: ['child cleaning workspace', 'child science cleanup'] },
    'Pick your art supplies.': { keywords: ['child picking art supplies', 'child art materials'] },
    'Draw or paint a picture.': { keywords: ['child drawing picture', 'child painting picture'] },
    'Show your art to the class.': { keywords: ['child showing art', 'child art class'] },
    'Hang your art on the wall.': { keywords: ['child hanging art', 'child art wall'] },
    'Take your art home.': { keywords: ['child taking art home', 'child art home'] },
    'Pick up your toys.': { keywords: ['child picking up toys', 'child cleaning toys'] },
    'Put away your books.': { keywords: ['child putting away books', 'child cleaning books'] },
    'Sweep the floor.': { keywords: ['child sweeping floor', 'child cleaning floor'] },
    'Wipe the table.': { keywords: ['child wiping table', 'child cleaning table'] },
    'Wash your hands.': { keywords: ['child washing hands', 'child hygiene'] },
    'Put on pajamas.': { keywords: ['child putting on pajamas', 'child pajamas bedtime'] },
    'Brush your teeth.': { keywords: ['child brushing teeth', 'kid brushing teeth', 'toothbrush child', 'bathroom child', 'child hygiene'] },
    'Read a bedtime story.': { keywords: ['child reading bedtime story', 'bedtime story child'] },
    'Say goodnight.': { keywords: ['child saying goodnight', 'child bedtime goodnight'] },
    'Go to sleep.': { keywords: ['child going to sleep', 'child sleeping bedtime'] },
    'Pack your suitcase.': { keywords: ['child packing suitcase', 'child suitcase', 'family travel'] },
    'Go to the airport.': { keywords: ['child at airport', 'family airport'] },
    'Fly on a plane.': { keywords: ['child flying plane', 'child airplane flight'] },
    'Arrive at your destination.': { keywords: ['child arriving destination', 'child travel destination'] },
    'Explore a new place.': { keywords: ['child exploring new place', 'child travel explore'] },
    'Tell your teacher it\'s your birthday.': { keywords: ['child birthday school', 'child telling teacher birthday'] },
    'Wear a birthday crown.': { keywords: ['child birthday crown', 'child wearing crown'] },
    'Share treats with your class.': { keywords: ['child sharing treats', 'child birthday treats'] },
    'Get a birthday card.': { keywords: ['child birthday card', 'child receiving card'] },
    'Take a class photo.': { keywords: ['child class photo', 'child school photo'] },
    'Pick something special to bring.': { keywords: ['child picking show and tell', 'child special item'] },
    'Show it to your class.': { keywords: ['child showing item class', 'child show and tell'] },
    'Tell a story about it.': { keywords: ['child telling story', 'child show and tell story'] },
    'Answer questions.': { keywords: ['child answering questions', 'child show and tell questions'] },
    'Put it back in your bag.': { keywords: ['child putting item in bag', 'child show and tell bag'] },
    'Get on the bus.': { keywords: ['child getting on bus', 'child bus ride'] },
    'Arrive at the destination.': { keywords: ['child arriving destination', 'child field trip destination'] },
    'Learn something new.': { keywords: ['child learning new thing', 'child field trip learning'] },
    'Eat lunch with friends.': { keywords: ['child eating lunch friends', 'child field trip lunch'] },
    'Return to school.': { keywords: ['child returning to school', 'child field trip return'] },
    'Wake up to birthday balloons.': { keywords: ['child birthday balloons', 'child waking up birthday'] },
    'Eat a special breakfast.': { keywords: ['child eating special breakfast', 'child birthday breakfast'] },
    'Open presents.': { keywords: ['child opening presents', 'child birthday presents'] },
    'Have a birthday dinner.': { keywords: ['child birthday dinner', 'child eating birthday dinner'] },
    'Blow out the candles.': { keywords: ['child blowing candles', 'birthday cake child', 'kids birthday cake'] },
    // --- New templates mappings ---
    // Zoo
    'Arrive at the zoo.': { keywords: ['zoo entrance', 'family at zoo', 'kids at zoo'] },
    'See the lions.': { keywords: ['lion at zoo', 'child watching lion', 'zoo animals'] },
    'Feed the giraffes.': { keywords: ['child feeding giraffe', 'giraffe zoo', 'kids feeding animals'] },
    'Watch the monkeys play.': { keywords: ['monkeys playing', 'child watching monkeys', 'zoo monkeys'] },
    'Eat lunch at the zoo cafe.': { keywords: ['child eating lunch zoo', 'zoo cafe', 'family lunch zoo'] },
    'Say goodbye to the animals.': { keywords: ['child waving animals', 'zoo goodbye', 'kids at zoo'] },
    // Beach
    'Pack your beach bag.': { keywords: ['child packing beach bag', 'beach bag', 'kids preparing beach'] },
    'Build a sandcastle.': { keywords: ['child building sandcastle', 'kids sandcastle', 'beach sandcastle'] },
    'Swim in the ocean.': { keywords: ['child swimming ocean', 'kids swimming beach', 'ocean swim child'] },
    'Collect seashells.': { keywords: ['child collecting seashells', 'kids seashells beach', 'beach shells child'] },
    'Eat ice cream.': { keywords: ['child eating ice cream', 'kids ice cream', 'ice cream beach'] },
    'Watch the sunset.': { keywords: ['beach sunset', 'child watching sunset', 'family sunset beach'] },
    // Birthday
    'Send out invitations.': { keywords: ['birthday invitation', 'child birthday invite', 'kids party invite'] },
    'Decorate the house.': { keywords: ['child decorating house', 'birthday decorations', 'kids party decor'] },
    'Play party games.': { keywords: ['child party games', 'kids playing games', 'birthday games children'] },
    'Blow out the candles.': { keywords: ['child blowing candles', 'birthday cake child', 'kids birthday cake'] },
    'Open presents.': { keywords: ['child opening presents', 'birthday gifts child', 'kids birthday presents'] },
    'Say thank you to friends.': { keywords: ['child saying thank you', 'kids gratitude', 'birthday thank you'] },
    // Park
    'Put on your shoes.': { keywords: ['child putting on shoes', 'kids shoes', 'getting ready park'] },
    'Walk to the park.': { keywords: ['child walking park', 'kids going park', 'family walk park'] },
    'Go down the slide.': { keywords: ['child on slide', 'kids playground slide', 'park slide child'] },
    'Swing on the swings.': { keywords: ['child on swing', 'kids swinging', 'playground swings'] },
    'Have a picnic.': { keywords: ['child picnic', 'family picnic park', 'kids eating picnic'] },
    'Walk home with family.': { keywords: ['child walking home', 'family walk', 'kids after park'] },
    // Library
    'Arrive at the library.': { keywords: ['child at library', 'library entrance', 'kids library'] },
    'Pick out a book.': { keywords: ['child picking book', 'kids choosing book', 'library books child'] },
    'Read quietly.': { keywords: ['child reading library', 'kids reading', 'quiet reading child'] },
    'Check out your book.': { keywords: ['child checking out book', 'library checkout child'] },
    'Say thank you to the librarian.': { keywords: ['child librarian', 'kids librarian', 'library thank you'] },
    // Dentist
    'Arrive at the dentist.': { keywords: ['child at dentist', 'dentist office child', 'kids dentist'] },
    'Sit in the big chair.': { keywords: ['child dentist chair', 'kids dental chair', 'dentist child'] },
    'Open your mouth wide.': { keywords: ['child open mouth dentist', 'kids dentist exam'] },
    'Get your teeth cleaned.': { keywords: ['child teeth cleaning', 'kids dental cleaning', 'dentist cleaning child'] },
    'Get a sticker for being brave!': { keywords: ['child sticker', 'child reward', 'child happy doctor', 'child bravery'] },
    // Grocery
    'Make a shopping list.': { keywords: ['child making shopping list', 'kids grocery list', 'family shopping list'] },
    'Go to the store.': { keywords: ['child at grocery store', 'kids grocery store', 'family shopping'] },
    'Pick out fruits and veggies.': { keywords: ['child picking fruits', 'kids vegetables grocery', 'grocery produce child'] },
    'Help put groceries in the cart.': { keywords: ['child grocery cart', 'kids shopping cart', 'grocery child'] },
    'Pay at the checkout.': { keywords: ['child grocery checkout', 'kids paying grocery', 'grocery cashier child'] },
    'Help put groceries away at home.': { keywords: ['child putting away groceries', 'kids unpacking groceries', 'family groceries home'] },
    // Swimming
    'Put on your swimsuit.': { keywords: ['child putting on swimsuit', 'kids swimsuit', 'swimming child'] },
    'Listen to the instructor.': { keywords: ['child listening instructor', 'kids swim lesson', 'swimming teacher child'] },
    'Practice kicking.': { keywords: ['child swim kicking', 'kids swimming lesson', 'swimming practice child'] },
    'Blow bubbles in the water.': { keywords: ['child blowing bubbles water', 'kids swim bubbles', 'swimming bubbles child'] },
    'Swim with a float.': { keywords: ['child swimming float', 'kids swim float', 'swimming aid child'] },
    'Get a high five for trying!': { keywords: ['child high five', 'kids encouragement', 'swimming lesson child'] },
    // Zoo
    'Arrive at the zoo.': { keywords: ['child at zoo', 'zoo entrance', 'family at zoo'] },
    'See the lions.': { keywords: ['lion at zoo', 'child watching lion', 'zoo animals'] },
    'Feed the giraffes.': { keywords: ['child feeding giraffe', 'giraffe zoo', 'kids feeding animals'] },
    'Watch the monkeys play.': { keywords: ['monkeys playing', 'child watching monkeys', 'zoo monkeys'] },
    'Eat lunch at the zoo cafe.': { keywords: ['child eating lunch zoo', 'zoo cafe', 'family lunch zoo'] },
    'Say goodbye to the animals.': { keywords: ['child waving animals', 'zoo goodbye', 'kids at zoo'] },
    // Beach
    'Pack your beach bag.': { keywords: ['child packing beach bag', 'beach bag', 'kids preparing beach'] },
    'Build a sandcastle.': { keywords: ['child building sandcastle', 'kids sandcastle', 'beach sandcastle'] },
    'Swim in the ocean.': { keywords: ['child swimming ocean', 'kids swimming beach', 'ocean swim child'] },
    'Collect seashells.': { keywords: ['child collecting seashells', 'kids seashells beach', 'beach shells child'] },
    'Eat ice cream.': { keywords: ['child eating ice cream', 'kids ice cream', 'ice cream beach'] },
    'Watch the sunset.': { keywords: ['beach sunset', 'child watching sunset', 'family sunset beach'] },
    // Birthday
    'Send out invitations.': { keywords: ['birthday invitation', 'child birthday invite', 'kids party invite'] },
    'Decorate the house.': { keywords: ['child decorating house', 'birthday decorations', 'kids party decor'] },
    'Play party games.': { keywords: ['child party games', 'kids playing games', 'birthday games children'] },
    'Blow out the candles.': { keywords: ['child blowing candles', 'birthday cake child', 'kids birthday cake'] },
    'Open presents.': { keywords: ['child opening presents', 'birthday gifts child', 'kids birthday presents'] },
    'Say thank you to friends.': { keywords: ['child saying thank you', 'kids gratitude', 'birthday thank you'] },
    // Park
    'Put on your shoes.': { keywords: ['child putting on shoes', 'kids shoes', 'getting ready park'] },
    'Walk to the park.': { keywords: ['child walking park', 'kids going park', 'family walk park'] },
    'Go down the slide.': { keywords: ['child on slide', 'kids playground slide', 'park slide child'] },
    'Swing on the swings.': { keywords: ['child on swing', 'kids swinging', 'playground swings'] },
    'Have a picnic.': { keywords: ['child picnic', 'family picnic park', 'kids eating picnic'] },
    'Walk home with family.': { keywords: ['child walking home', 'family walk', 'kids after park'] },
    // Library
    'Arrive at the library.': { keywords: ['child at library', 'library entrance', 'kids library'] },
    'Pick out a book.': { keywords: ['child picking book', 'kids choosing book', 'library books child'] },
    'Read quietly.': { keywords: ['child reading library', 'kids reading', 'quiet reading child'] },
    'Check out your book.': { keywords: ['child checking out book', 'library checkout child'] },
    'Say thank you to the librarian.': { keywords: ['child librarian', 'kids librarian', 'library thank you'] },
    // Dentist
    'Arrive at the dentist.': { keywords: ['child at dentist', 'dentist office child', 'kids dentist'] },
    'Sit in the big chair.': { keywords: ['child dentist chair', 'kids dental chair', 'dentist child'] },
    'Open your mouth wide.': { keywords: ['child open mouth dentist', 'kids dentist exam'] },
    'Get your teeth cleaned.': { keywords: ['child teeth cleaning', 'kids dental cleaning', 'dentist cleaning child'] },
    'Get a sticker for being brave!': { keywords: ['child sticker', 'child reward', 'child happy doctor', 'child bravery'] },
    // Grocery
    'Make a shopping list.': { keywords: ['child making shopping list', 'kids grocery list', 'family shopping list'] },
    'Go to the store.': { keywords: ['child at grocery store', 'kids grocery store', 'family shopping'] },
    'Pick out fruits and veggies.': { keywords: ['child picking fruits', 'kids vegetables grocery', 'grocery produce child'] },
    'Help put groceries in the cart.': { keywords: ['child grocery cart', 'kids shopping cart', 'grocery child'] },
    'Pay at the checkout.': { keywords: ['child grocery checkout', 'kids paying grocery', 'grocery cashier child'] },
    'Help put groceries away at home.': { keywords: ['child putting away groceries', 'kids unpacking groceries', 'family groceries home'] },
    // Swimming
    'Put on your swimsuit.': { keywords: ['child putting on swimsuit', 'kids swimsuit', 'swimming child'] },
    'Listen to the instructor.': { keywords: ['child listening instructor', 'kids swim lesson', 'swimming teacher child'] },
    'Practice kicking.': { keywords: ['child swim kicking', 'kids swimming lesson', 'swimming practice child'] },
    'Blow bubbles in the water.': { keywords: ['child blowing bubbles water', 'kids swim bubbles', 'swimming bubbles child'] },
    'Swim with a float.': { keywords: ['child swimming float', 'kids swim float', 'swimming aid child'] },
    'Get a high five for trying!': { keywords: ['child high five', 'kids encouragement', 'swimming lesson child'] },
    // ...continue this pattern for all new template page texts...
};


// (B) Try curated URL, then multiple keywords, then fallback
async function fetchSerpApiImage(query) {
    const entry = serpImageMap[query];
    // Try each keyword in order
    if (entry && entry.keywords && entry.keywords.length > 0) {
        for (const keyword of entry.keywords) {
            const url = `/api/serpapi_image_search?query=${encodeURIComponent(keyword)}`;
            try {
                const response = await fetch(url);
                if (!response.ok) continue;
                const data = await response.json();
                if (data.url && typeof data.url === 'string' && data.url.trim() !== '') return data.url;
            } catch (err) {
                // continue
            }
        }
    }
    // Fallback: try the original text
    const fallbackUrl = `/api/serpapi_image_search?query=${encodeURIComponent(query)}`;
    try {
        const response = await fetch(fallbackUrl);
        if (!response.ok) return getFallbackImageUrl();
        const data = await response.json();
        if (data.url && typeof data.url === 'string' && data.url.trim() !== '') return data.url;
    } catch (err) {
        // continue
    }
    // If all fails, return fallback image
    return getFallbackImageUrl();
}

// Returns a fallback image URL (should be a static asset in your project)
function getFallbackImageUrl() {
    return '/static/img/profile_1.png'; // Change to your preferred placeholder
}
